# Frontend Brief for Backend LLM

## Project Context

I'm the LLM working on the **frontend UI** for the MGraph HTML Graph service. The UI is a browser-based playground that visualizes HTML as graph structures using multiple rendering engines.

**Tech stack:** Vanilla JS, Web Components, no build step. Files served statically from FastAPI.

---

## API Endpoints the Frontend Expects

### Graph Conversion Endpoints

All endpoints accept POST with JSON body:

```python
# Request schema (same for all)
{
    "html": str,                    # HTML content to parse
    "preset": str,                  # "FULL_DETAIL" | "STRUCTURE_ONLY" | "MINIMAL"
    "show_tag_nodes": bool,         # Include tag nodes
    "show_attr_nodes": bool,        # Include attribute nodes
    "show_text_nodes": bool,        # Include text nodes
    "color_scheme": str             # "DEFAULT" | "MONOCHROME" | "HIGH_CONTRAST"
}
```

| Endpoint | Response Format |
|----------|-----------------|
| `POST /graph/from/html/to/dot/{transformation}` | `{ dot: str, stats: Stats, duration: float }` |
| `POST /graph/from/html/to/visjs/{transformation}` | `{ nodes: [], edges: [], stats: Stats, duration: float }` |
| `POST /graph/from/html/to/d3/{transformation}` | `{ nodes: [], links: [], stats: Stats, duration: float }` |
| `POST /graph/from/html/to/cytoscape/{transformation}` | `{ elements: {nodes: [], edges: []}, stats: Stats, duration: float }` |
| `POST /graph/from/html/to/mermaid/{transformation}` | `{ mermaid: str, stats: Stats, duration: float }` |

The `{transformation}` path parameter defaults to `"default"` and selects graph transformation logic.

### Stats Object

```python
Stats = {
    "total_nodes": int,
    "total_edges": int,
    "element_nodes": int,
    "value_nodes": int,
    "tag_nodes": int,
    "text_nodes": int,
    "attr_nodes": int
}
```

### Transformations Endpoint

```
GET /graph/transformations
```

Returns:
```python
[
    { "name": "default", "label": "Default", "description": "..." },
    { "name": "semantic", "label": "Semantic", "description": "..." },
    ...
]
```

### Other Endpoints Used

| Endpoint | Purpose |
|----------|---------|
| `GET /info/health` | Health check (returns 200 OK) |
| `POST /html/from/url` | Fetch HTML from URL: `{ url: str, timeout: int }` â†’ `{ html: str, url: str, content_type: str }` |

---

## Native Format Specifications

### vis.js Format

```python
{
    "nodes": [
        {
            "id": str,
            "label": str,
            "color": { "background": str, "border": str },
            "font": { "color": str },
            "title": str,           # Tooltip
            "shape": str            # "box", "ellipse", etc.
        }
    ],
    "edges": [
        {
            "from": str,            # NOTE: Python uses "from_node" to avoid keyword
            "to": str,
            "dashes": bool,
            "color": { "color": str }
        }
    ]
}
```

**Important:** Python `from` keyword conflict - backend may use `from_node`, frontend handles both.

### D3 Format

```python
{
    "nodes": [
        {
            "id": str,
            "label": str,
            "color": str,           # Hex color
            "fontColor": str,
            "radius": int,          # Optional, default 25
            "domPath": str          # Optional, for tooltip
        }
    ],
    "links": [                      # NOTE: "links" not "edges"
        {
            "source": str,
            "target": str,
            "color": str,
            "width": float,
            "dashed": bool
        }
    ]
}
```

### Cytoscape Format

```python
{
    "elements": {
        "nodes": [
            {
                "data": {
                    "id": str,
                    "label": str,
                    "color": str,
                    "fontColor": str,
                    "borderColor": str
                }
            }
        ],
        "edges": [
            {
                "data": {
                    "id": str,
                    "source": str,
                    "target": str,
                    "color": str,
                    "dashed": bool
                }
            }
        ]
    }
}
```

### Mermaid Format

```python
{
    "mermaid": str,  # Pre-generated Mermaid flowchart code
    "mermaid_size": int
}
```

Example mermaid string:
```
flowchart TB
    n0[div]
    n1[p]
    n0 --> n1
    style n0 fill:#E8E8E8,stroke:#999999
```

---

## Current Frontend Capabilities

- **6 Renderers:** DOT (viz.js WASM), vis.js, D3, Cytoscape, Mermaid, PlantUML
- **Maximize mode:** Fullscreen graph view
- **Keyboard shortcuts:** Configurable via JSON
- **Transformation selector:** Dropdown populated from `/graph/transformations`
- **Auto-render:** Debounced re-render on HTML/config change

---

## Coordination Notes

1. **Transformation parameter** was added in v0.2.5 - all graph endpoints now expect `/{transformation}` suffix
2. **Stats object** should be consistent across all endpoints
3. **Duration** field helps frontend show server processing time separately from network latency
4. **Color values** should be valid CSS hex colors (`#RRGGBB`)